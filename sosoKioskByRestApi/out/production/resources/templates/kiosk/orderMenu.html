<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>kiosk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <div th:replace="/kiosk/kiosk-fragment/script.html :: all-script"></div>
    <div th:replace="/kiosk/kiosk-fragment/css.html :: all-css"></div>

    <!--    websocket-->
    <script src="/webjars/sockjs-client/sockjs.min.js"></script>
    <script src="/webjars/stomp-websocket/stomp.min.js"></script>

    <script rel="javascript" type="text/javascript" th:src="@{/js/all/orderMenu.js}"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        var placeStatus = [[${status}]];
        /*]]>*/

        var moneyStompClient;
        var moneySendData = null;
        var sosoServerStatus = true;

        $(document).ready(function () {

            var moneySocket = new SockJS('https://soso-kitchen.com/user/websocket');
            // var moneySocket = new SockJS('http://127.0.0.1:8081/user/websocket');

            moneyStompClient = Stomp.over(moneySocket);

            sosoServerStatus = moneyStompClient.connected;

            moneyStompClient.connect({}, function (frame) {

                sosoServerStatus = moneyStompClient.connected;

                moneyStompClient.subscribe('/sendAdminMessage/kiosk/order', function (greeting) {


                    if (sosoServerStatus == false) {
                        voice("서버 실행을 위해 관리자에게 문의 해주세요");
                        cancelOrder(moneySendData);
                        payErrorModal("소소한 부엌 서버를 실행시켜주세요.");
                    }

                    var data = JSON.parse(greeting.body).message;

                    if (data == "noStart") {
                        voice("키오스크를 실행 시켜 주세요");
                        cancelOrder(moneySendData);
                        payErrorModal("소소한 부엌에서 키오스크를 실행시켜주세요.");
                    } else if (data == "orderAfterNoStart") {
                        voice("키오스크를 실행 시켜 주세요");
                        cancelOrder(moneySendData);
                        payErrorModal("키오스크를 실행시켜주세요.");
                    } else if (data == "error") {
                        voice("관리자에게 문의해주세요");
                        cancelOrder(moneySendData);
                        payErrorModal("데이터 저장 에러 (관리자에게 문의해주세요) ");
                    } else {
                        successPayModalShowByMoney();
                        setTime();
                    }

                });

            });


            setTimeout(function () {
                if (sosoServerStatus == false) { //서버 닫혀있음.
                    payErrorModal("소소한 부엌 서버가 닫혀있습니다. (관리자에게 문의해주세요) ");
                }
            }, 3000);


        });
    </script>
</head>
<body oncontextmenu='return false' onselectstart='return false' ondragstart='return false'> <!--우클릭 드래그 등등 방지-->

<!--결제 전 메뉴 확인 모달창-->
<div class="O-modal-back" id="checkMenuModal">
    <div class="O-modal" style="width: 85%">
        <div class="O-modal-content">
            <div class="O-modal-header">
                <div class="O-modal-close-Btn">
                    <div class="O-close O-close3" id="payModalCloseBtn" onclick="payModalClose()"></div>
                </div>
                <div class="O-modal-top">
                    <div class="O-pay-modal-top-title M-font">
                        <p>주문 목록</p>
                    </div>
                </div>
            </div>
            <div class="O-pay-modal-side-order M-overlay">
                <div style="width: 100%;height: 10%;border-bottom: 1px solid #e5e5e5;margin-bottom: 10px"
                     class="M-flex-row">
                    <div class="M-flex-row M-flex-center M-font O-font-number-size" style="width: 50%">
                        <p>메뉴</p>
                    </div>
                    <div class="M-flex-row M-flex-center M-font O-font-number-size" style="width: 50%">
                        <p>사이드</p>
                    </div>
                </div>
                <div class="O-side-order-part O-pay-order-part-up">
                    <!--                    <div class="O-pay-order-part M-flex-row">-->
                    <!--                        <div class="O-pay-order-card O-pay-order-card-left">-->
                    <!--                            <div class="O-pay-img">-->
                    <!--                                <img src="/kiosk/img/side/20220208201721.png" class="O-side-img">-->
                    <!--                            </div>-->
                    <!--                            <div class="O-pay-name M-font O-font-middle-size M-flex-column M-flex-center">-->
                    <!--                                <p class="">2</p>-->
                    <!--                            </div>-->
                    <!--                            <div class="O-pay-number M-flex-column M-flex-center">-->
                    <!--                                <div class="M-font O-font-middle-size M-flex-column M-flex-center">-->
                    <!--                                    <p>0개</p>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="O-pay-price M-flex-column M-flex-center">-->
                    <!--                                <div class="M-font O-font-middle-size M-flex-column M-flex-center">-->
                    <!--                                    <p>100원</p>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                        <div class="O-pay-order-card O-pay-order-card-right M-flex-column">-->
                    <!--                            <div class="O-pay-order-card-div M-flex-row">-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px; width: 30%;">-->
                    <!--                                    <p class="">사이드</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px;width: 10%">-->
                    <!--                                    <p class="">10개</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-number M-flex-column M-flex-center" style="width: 20%">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>10000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-price M-flex-column M-flex-center" style="width: 40%;">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>총가격 : 100000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="O-pay-order-card-div M-flex-row">-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px; width: 30%;">-->
                    <!--                                    <p class="">사이드</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px;width: 10%">-->
                    <!--                                    <p class="">10개</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-number M-flex-column M-flex-center" style="width: 20%">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>10000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-price M-flex-column M-flex-center" style="width: 40%;">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>총가격 : 100000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="O-pay-order-card-div M-flex-row">-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px; width: 30%;">-->
                    <!--                                    <p class="">사이드</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-name M-font M-flex-column M-flex-center"-->
                    <!--                                     style="font-size: 30px;width: 10%">-->
                    <!--                                    <p class="">10개</p>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-number M-flex-column M-flex-center" style="width: 20%">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>10000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                                <div class="O-pay-price M-flex-column M-flex-center" style="width: 40%;">-->
                    <!--                                    <div class="M-font M-flex-column M-flex-center" style="font-size: 30px;">-->
                    <!--                                        <p>총가격 : 100000원</p>-->
                    <!--                                    </div>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                </div>
                <div style="width: 100%; height: 35%;"
                     class="O-pay-totalPrice M-flex-center M-flex-row M-font O-font-middle-size">
                    <p></p>
                </div>
            </div>
            <div class="O-pay-modal-side-footer">
                <div class="O-side-select-menu-part-left M-flex-row M-flex-center">
                </div>
                <div class="O-side-select-part w-M-overlay">
                    <div class="O-pay-menu-part M-flex-column M-flex-center">
                        <!--                        <div class="O-pay-select-close M-flex-column M-flex-center"-->
                        <!--                             onclick="liquidateMenu()"-->
                        <!--                             style="width: 50%; height: 50%; background-color: #eb8282;">-->
                        <!--                            <p class="M-font O-font-middle-size">결제 하기</p>-->
                        <!--                        </div>-->
                    </div>
                </div>
                <div class="O-side-select-ok-part">
                </div>
            </div>
        </div>
    </div>
</div>

<!--메뉴, 사이드 모달창-->
<div class="O-modal-back" id="menuOrSideModal">
    <div class="O-modal">
        <div class="O-modal-content">
            <div class="O-modal-header">
                <div class="O-modal-close-Btn">
                    <div class="O-close O-close3" id="modalCloseBtn" onclick="modalClose()"></div>
                </div>
                <div class="O-modal-top">
                    <div class="O-modal-top-title M-font">
                        <p></p>
                    </div>
                </div>
            </div>
            <div class="O-modal-category-bar">
                <!--                <div class="O-category-part">-->
                <!--                    <div class="M-font O-font-mini-size O-category-box O-category-click-color">-->
                <!--                        <p>카테고리 1</p>-->
                <!--                    </div>-->
                <!--                </div>-->
            </div>
            <div class="O-modal-side-order M-overlay">
                <div class="O-side-order-part">

                    <!--                    <div class="O-side-order-card">-->
                    <!--                        <div class="O-menu-side-img">-->
                    <!--                            <img th:src="@{/kiosk/img.jpg}" class="O-side-img">-->
                    <!--                        </div>-->
                    <!--                        <div class="O-menu-side-name M-font O-font-mini-size M-text-center">-->
                    <!--                            <p class="O-menu-side-name-p">사이드 1</p>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                    <div class="M-container M-flex-row M-flex-center">-->
                    <!--                        <div class="O-select-mini-card" style="width: 60%;">-->
                    <!--                            <div class="O-mini-card-header" style="width: 70%; height: 200px;">-->
                    <!--                                <div class="O-mini-card-header-img">-->
                    <!--                                    <img class="O-mini-img" th:src="@{/kiosk/img.jpg}">-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="O-mini-card-body">-->
                    <!--                                <div class="O-mini-card-body-content">-->
                    <!--                                    <p class="M-font O-font-mini-size">메뉴이름</p>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                        <div class="O-menu-side-number M-flex-column M-flex-center">-->
                    <!--                            <div class="side-number-top M-font O-font-middle-size"-->
                    <!--                                 onclick="upOrDownSideMenu(true, this,16)">+-->
                    <!--                            </div>-->
                    <!--                            <div class="M-font O-font-middle-size"><input type="hidden" value="16" id="hiddenSideSq16">-->
                    <!--                                <p>0</p></div>-->
                    <!--                            <div class="side-number-bottom M-font O-font-middle-size"-->
                    <!--                                 onclick="upOrDownSideMenu(false, this,16)">- -->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                </div>
            </div>
            <div class="O-modal-side-footer">
                <div class="O-side-select-menu-part-left M-flex-row M-flex-center">
                    <!--                                        <div class="O-select-mini-card" style="width: 85%;">-->
                    <!--                                            <div class="O-mini-card-header">-->
                    <!--                                                <div class="O-mini-card-header-img">-->
                    <!--                                                    <img class="O-mini-img" src="/kiosk/img.jpg">-->
                    <!--                                                </div>-->
                    <!--                                            </div>-->
                    <!--                                            <div class="O-mini-card-body">-->
                    <!--                                                <div class="O-mini-card-body-content">-->
                    <!--                                                    <p class="M-font O-font-mini-size">메뉴이름</p>-->
                    <!--                                                </div>-->
                    <!--                                            </div>-->
                    <!--                                        </div>-->
                </div>
                <div class="O-side-select-part w-M-overlay">
                    <div class="O-side-select-menu-part">
                        <!--                        <div class="O-side-select-close M-flex-column M-flex-center" onclick="deleteMenu(17)"-->
                        <!--                             style="width: 100%; height: 80%; background-color: #eb8282;">-->
                        <!--                            <p class="M-font O-font-middle-size">메뉴 추가</p>-->
                        <!--                        </div>-->

                        <!--                        <div class="O-side-select-card">-->
                        <!--                            <div class="O-side-select-number">-->
                        <!--                                <p class="M-font O-font-number-size" name="sideSelectSize">1</p>-->
                        <!--                            </div>-->
                        <!--                            <div class="O-side-mini-close-Btn">-->
                        <!--                                <div class="O-close O-close2"></div>-->
                        <!--                            </div>-->
                        <!--                            <div class="O-side-select-name">-->
                        <!--                                <input type="hidden" value="" name="sideSelectSq">-->
                        <!--                                <p class="M-font O-font-mini-size">사이드 1</p>-->
                        <!--                            </div>-->
                        <!--                        </div>-->

                    </div>
                </div>
                <div class="O-side-select-ok-part">
                    <div class="O-side-select-ok">
                        <p class="M-font O-font-middle-size" onclick="selectSideBtn()">선택 완료</p>
                    </div>
                    <div class="O-side-select-close">
                        <p class="M-font O-font-middle-size">닫기</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--영수증 모달-->
<div class="O-modal-back" id="receiptModal">
    <div class="O-modal" style="width: 40%; height: 35%">
        <div class="O-modal-content">
            <div class="O-modal-header">
                <div class="O-modal-close-Btn">
                    <div class="O-close O-close3" id="receiptModalCloseBtn" onclick="receiptModalClose()"></div>
                </div>
                <div class="O-modal-top">
                    <!--                    <div class="O-modal-top-title M-font" id="deleteTop">-->
                    <!--                        <p></p>-->
                    <!--                    </div>-->
                </div>
            </div>
            <div class="O-modal-category-bar">
            </div>
            <div class="O-modal-side-order" style="height: 40%;text-align: center;" id="delete-modal-Body">
                <small style="font-size: 20px;">영수증을 출력하시겠습니까?</small>
            </div>
            <div class="O-modal-side-footer M-flex-j-center" id="">
                <div class="O-receipt-modal-btn" onclick="liquidateMenuByMoney(true)"
                     style="width: 35%; background-color: #e9e9e9;">
                    <p class="M-font O-font-middle-size">네</p>
                </div>
                <div class="O-receipt-modal-btn" onclick="liquidateMenuByMoney(false)"
                     style="width: 35%; margin-left: 30px; background-color: #e9e9e9;">
                    <p class="M-font O-font-middle-size">아니요</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!--결제 성공 모달-->
<div class="O-modal-back" id="successPay">
    <div class="O-modal" style="width: 40%; height: 50%">
        <div class="O-modal-content">
            <div class="O-modal-header">
                <div class="O-modal-close-Btn">
                    <div class="O-close O-close3" id="successPayModal" onclick="successPayModalClose()"></div>
                </div>
                <div class="O-modal-top">
                    <!--                    <div class="O-modal-top-title M-font" id="deleteTop">-->
                    <!--                        <p></p>-->
                    <!--                    </div>-->
                </div>
            </div>
            <div class="O-modal-category-bar">
            </div>
            <div class="O-modal-side-order" style="height: 40%;text-align: center;" id="success-pay-modal-Body">
                <small style="font-size: 30px;">주문이 완료 되었습니다.</small><br>
                <small style="font-size: 30px;">번호표를 확인해주세요.</small><br>
                <small style="font-size: 30px;" id="successPayTime">10</small>
            </div>
            <div class="O-modal-side-footer M-flex-j-center" style="margin-top: 30px;height: 15%;">
                <div class="O-receipt-modal-btn" onclick="successPayModalClose()"
                     style="width: 35%; background-color: #d56161;">
                    <p class="M-font O-font-middle-size">닫기</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!--결제 실패 모달-->
<div class="O-modal-back" id="failPay" style="z-index: 10">
    <div class="O-modal" style="width: 40%; height: 50%">
        <div class="O-modal-content">
            <div class="O-modal-header" style="height: 20%;">
                <div class="O-modal-close-Btn">
                    <div class="O-close O-close3" id="successPayModal" onclick="successPayModalClose()"></div>
                </div>
                <div class="O-modal-top">
                    <!--                    <div class="O-modal-top-title M-font" id="deleteTop">-->
                    <!--                        <p></p>-->
                    <!--                    </div>-->
                </div>
            </div>
            <div class="O-modal-side-order" style="height: 40%;text-align: center;" id="fail-pay-modal-Body">
                <!--                <small style="font-size: 30px;">주문에 실패하였습니다.</small><br>-->
                <!--                <small style="font-size: 30px;">결제가 진행되었을 시</small><br>-->
                <!--                <small style="font-size: 30px;">관리자에게 문의 바랍니다.</small>-->
            </div>
            <div class="O-modal-side-footer M-flex-j-center" style="margin-top: 30px;height: 15%;">
                <div class="O-receipt-modal-btn" onclick="successPayModalClose()"
                     style="width: 35%; background-color: #d56161;">
                    <p class="M-font O-font-middle-size">닫기</p>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container" id="addMenuContainer">
    <div class="container M-flex-row">
        <div class="O-order-side-all">
            <div class="O-order-Side">
                <div class="side-up-container">
                    <div class="storeName">
                        <p th:text="#{category}" class="M-font" style="font-size: 80px;"></p>
                    </div>
                </div>
                <div class="O-category">
                    <div class="O-category-list">
                        <div style="height: 68%;" class="M-overlay">
                            <div class="O-category-list2" style="height: 100%;display: block;">
                                <div class="text M-font O-category-font O-category-Side">
                                    <div class="O-category-name O-click-color"
                                         onclick="selectCategoryByMenu(this, 0)">
                                        <a class="O-category-a">전체</a>
                                    </div>
                                </div>
                                <div class="text M-font O-category-font O-category-Side"
                                     th:each="categoryList : ${categoryDTO}">
                                    <div class="O-category-name"
                                         th:onclick="selectCategoryByMenu(this,[[${categoryList.categorySq}]])">
                                        <a class="O-category-a" th:text="${categoryList.categoryName}">카테고리 이름</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="totalPrice-div M-flex-column M-flex-center" style="width: 100%">
                            <!--                            <div class="M-font O-font-middle-size">-->
                            <!--                                <span>총액 : </span>-->
                            <!--                                <span>100000원</span>-->
                            <!--                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="O-main">
            <div class="O-top">
                <div>
                    <div class="O-top-left">
                        <div style="width: 18%;">
                            <img th:src="@{/kiosk/backImg.png}" id="indexBackBtn" onclick="location.href='/'"
                                 style="width: 100%">
                        </div>
                    </div>
                    <div class="O-top-center">
                        <div>
                            <p class="O-font-menu-size M-font" th:text="#{menu}"></p>
                        </div>
                    </div>
                    <div class="O-top-right">
                    </div>
                </div>
            </div>
            <div class="O-center O-font-center M-font">
                <div class="O-center-menu">
                    <div style="width: 100%;height: 96%;" class="M-overlay">
                        <div class="O-flex-menu">
                            <!--                            <div class="O-card">-->
                            <!--                                <div class="O-card-all">-->
                            <!--                                    <div class="O-card-header">-->
                            <!--                                        <div class="O-card-header-img">-->
                            <!--                                            <img class="O-card-header-img-img">-->
                            <!--                                        </div>-->
                            <!--                                    </div>-->
                            <!--                                    <div class="O-card-body">-->
                            <!--                                        <div class="O-card-body-top">-->
                            <!--                                            <p class="O-menu-name">메뉴이름</p>-->
                            <!--                                        </div>-->
                            <!--                                        <div class="O-card-body-body">-->
                            <!--                                            <div style="text-align: center;">-->
                            <!--                                                <p class="O-menu-name" style="display: inline-block">가격 : </p>-->
                            <!--                                                <p class="O-menu-name" style="display: inline-block">10000</p>-->
                            <!--                                            </div>-->
                            <!--                                        </div>-->
                            <!--                                    </div>-->
                            <!--                                </div>-->
                            <!--                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="O-footer">
                <div class="O-footer-div">
                    <div class="O-footer-select-menu">
                        <div class="O-footer-select-menu-all">
                            <div class="O-mini-select-bar w-M-overlay" style="padding-top: 3%;">
                                <!--                                                                <div class="O-select-mini-card">-->
                                <!--                                                                    <div class="O-select-mini-number">-->
                                <!--                                                                        <p class="M-font O-font-number-size">1</p>-->
                                <!--                                                                    </div>-->
                                <!--                                                                                                    <div class="O-select-mini-close-Btn">-->
                                <!--                                                                        <div class="O-close O-close2"></div>-->
                                <!--                                                                    </div>-->
                                <!--                                                                    <div class="O-mini-card-header">-->
                                <!--                                                                        <div class="O-mini-card-header-img">-->
                                <!--                                                                            <img class="O-mini-img" th:src="@{/kiosk/img.jpg}">-->
                                <!--                                                                        </div>-->
                                <!--                                                                    </div>-->
                                <!--                                                                    <div class="O-mini-card-body">-->
                                <!--                                                                        <div class="O-mini-card-body-content">-->
                                <!--                                                                            <p class="M-font O-font-mini-size">메뉴이름</p>-->
                                <!--                                                                        </div>-->
                                <!--                                                                    </div>-->
                                <!--                                                                </div>-->
                            </div>
                        </div>
                    </div>
                    <div class="O-footer-buy-Btn M-font O-select-font">
                        <div class="O-footer-buy-Btn-all">
                            <div class="O-card-Btn M-width-80 M-flex-row M-flex-center"
                                 onclick="showCheckModal('card')">
                                <a style="text-decoration: none; color: black">카드결제</a>
                            </div>
                            <div class="O-money-Btn M-width-80 M-flex-row M-flex-center"
                                 onclick="showCheckModal('money')">
                                <a style="text-decoration: none; color: black">현금결제</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>